---
id: 7
title: What Happens When You Type Reddit.com Into Your Browser ? Part(2) (Network)
createdAt: "2022-12-14 5:00:00"
# image field is not mandatory
# you can skip it to keep the size of blog cards small
image: /images/whathappens/Howinternetworks.jpg
tags:
  - network
  - dns
category: dev
author:
  name: Ashraf
  twitter: Er3bu5_
  image: /images/portfolio.png
---

This article is part 2 of my How Internet Works series.

Part 1 : [Part 1 (DNS)]()

---  

## Set up a connection to the server.  
After getting the IP address, how do the browser and the server communicate with each other?  
##### TCP Handshake  
Once the IP address is known, the browser sets up a connection to the server via a TCP three-way handshake. This mechanism is designed to exchange the parameters of the network TCP socket connection before transmitting data, often over HTTPS.

HTTP/S is the secure version of HTTP, which is the primary protocol used to send data between a web browser and a website. HTTPS is encrypted in order to increase data transfer security.This is particularly important when users transmit sensitive data, such as when logging into a bank account, using an email service, etc.  
To establish the connection between the server and the browser, a TCP three-way handshake must happen first.

TCP's three-way handshaking technique is often referred to as SYN, SYN-ACK, and ACK—because there are three messages transmitted by TCP to negotiate and start a TCP session between two computers. Yes, this means three more messages back and forth between each server, and the request has yet to be made.

##### TLS Negotiation  
For secure connections established over HTTPS, another "handshake" is required. This handshake, or rather the TLS, determines which cypher will be used to encrypt the communication, verifies the server, and establishes that a secure connection is in place before beginning the actual transfer of data. This requires three more round trips to the server before the request for content is actually sent.

So, here is a summarised version of the TCP  and TLS handshakes.  
![/images/whathappens/1670269601196.jpg](/images/whathappens/1670269601196.jpg)


#### Let's inspect: What really happens from the network perspective?  
1. First, a DNS query takes place from my host (source) to my router (destination) to get the IP address of reddit.com.  
![/images/whathappens/dns-query12.png](/images/whathappens/dns-query12.png)

   *  Notice the request flag highlighted in yellow; that is the flag that tells the destination to do the recursive lookup if it doesn't have the IP address.

2. Second, we get the response after the long DNS trip discussed earlier.  
![/images/whathappens/dns_response21.png](/images/whathappens/dns_response21.png)
The flag highlighted is to show that this is a DNS response query to an earlier request.  
* The IP address of reddit.com is located in the Answer section.  
* If you notice there are four answers, that means that the server at Reddit has some kind of load balancer. Check out my load balancer blog ([LINK](https://a4raf-gehad.netlify.app/blog/loadbalancer)).  
* Time To Live (TTL): the number of seconds this record will remain in my system before requesting a new value.  
**3- TCP 3-way handshake**   
**3.1- SYN :** My network begins the connection by sending the TCP SYN packet to reddit.com. The packets contain a random sequence number that indicates the beginning of the sequence numbers for data transmission (example: 1234).  
    ![[syn.png]]  
**3.2-SYN-ACK:** After that, the server will receive the packet, and it will respond with its sequence number. Its response also includes the acknowledgment number, which is my network sequence number incremented by 1 (1235).  
![/images/whathappens/syn-ack.png](/images/whathappens/syn-ack.png)
**3.3-ACK:** My network responds to the server by sending the acknowledgment number, which is mostly the server’s sequence number that is incremented by 1.  
![/images/whathappens/ack.png](/images/whathappens/ack.png)
**4: TLS handshake**  
**4.1. Client Hello and Server Hello:** The client initiates the handshake by sending a "hello" message to the server. The message will include which TLS version the client supports, the cypher supported, and a string of random bytes known as the "client random." The server sends a message containing the server's chosen cipher and the "server random," another random string of bytes that's generated by the server.  
![/images/whathappens/client-hello.png](/images/whathappens/client-hello.png)
**Client Key Exchange and Finish:** The client verifies the signature and certificate before generating the master secret.  The server sends a "finished" message encrypted with a session key. The handshake is complete, and communication continues using the session keys.  
![/images/whathappens/client-finish.png](/images/whathappens/client-finish.png)
**4.3. Application Data:**  Now, the server sends the data requested by the user, but encrypted.  
![/images/whathappens/all.png](/images/whathappens/all.png)
